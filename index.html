<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanctum Playbook v3.0 | Enterprise</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
            --sanctum-green: #5A6955;
            --sanctum-dark: #1a2118;
            --sanctum-bg: #F2F0EB;
            --white: #FFFFFF;
            --shadow: 0 4px 20px rgba(0,0,0,0.06);
            --border: #e0e0e0;
            --tag-bg: #e8ece9;
        }

        body { font-family: 'Inter', sans-serif; background-color: var(--sanctum-bg); margin: 0; padding: 20px; color: var(--sanctum-dark); }
        .container { max-width: 800px; margin: 0 auto; padding-bottom: 100px; }

        header { text-align: center; margin-bottom: 30px; }
        h1 { font-family: 'Playfair Display', serif; color: var(--sanctum-green); margin: 0; font-size: 2rem; }
        .subtitle { font-size: 0.8rem; letter-spacing: 2px; text-transform: uppercase; color: #888; margin-top: 5px; }

        /* CONTROLS */
        .control-panel {
            background: var(--white); padding: 25px; border-radius: 12px;
            box-shadow: var(--shadow); position: sticky; top: 15px; z-index: 100;
            border: 1px solid rgba(90, 105, 85, 0.1);
        }

        .inputs-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        
        .input-group label { display: block; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; margin-bottom: 6px; color: var(--sanctum-green); letter-spacing: 0.5px; }
        .input-field {
            width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 6px;
            font-family: 'Inter', sans-serif; font-size: 0.95rem; transition: 0.3s; box-sizing: border-box;
        }
        .input-field:focus { outline: none; border-color: var(--sanctum-green); background: #fafafa; }

        /* SEARCH BAR EMPHASIS */
        #searchFilter { border-color: var(--sanctum-green); background-color: #f9fbf9; }

        /* FILTERS */
        .filter-nav { display: flex; gap: 8px; overflow-x: auto; padding: 15px 0; scrollbar-width: none; }
        .filter-btn {
            background: white; border: 1px solid var(--border); padding: 8px 16px;
            border-radius: 30px; cursor: pointer; white-space: nowrap; font-size: 0.8rem; color: #555; font-weight: 500;
        }
        .filter-btn:hover { background: #f5f5f5; }
        .filter-btn.active { background: var(--sanctum-green); color: white; border-color: var(--sanctum-green); }
        
        /* CARDS */
        .script-list { display: grid; gap: 15px; }
        .script-card {
            background: var(--white); border-radius: 8px; overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03); transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid transparent; cursor: pointer;
        }
        .script-card:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.08); border-color: var(--sanctum-green); }

        .card-header {
            padding: 12px 20px; background: #fafafa; border-bottom: 1px solid #eee;
            display: flex; justify-content: space-between; align-items: center;
        }
        .card-title { font-weight: 600; font-size: 0.9rem; color: var(--sanctum-dark); }
        .card-tag { font-size: 0.65rem; background: var(--tag-bg); padding: 4px 8px; border-radius: 4px; color: #555; text-transform: uppercase; font-weight: 600; }

        .card-body { padding: 20px; position: relative; }
        .whatsapp-bubble {
            background: #dcf8c6; padding: 15px; border-radius: 0 10px 10px 10px;
            font-size: 0.95rem; line-height: 1.5; color: #111; position: relative;
        }
        .whatsapp-bubble::before {
            content: ''; position: absolute; top: 0; left: -8px; width: 0; height: 0;
            border-top: 10px solid #dcf8c6; border-left: 10px solid transparent;
        }

        .highlight-name { color: #000; font-weight: bold; background: rgba(255,255,255,0.4); padding: 0 2px; }

        /* TOAST */
        .toast {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px);
            background: #333; color: white; padding: 12px 24px; border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); transition: transform 0.3s; z-index: 1000; font-size: 0.9rem;
        }
        .toast.show { transform: translateX(-50%) translateY(0); }

        @media (max-width: 600px) { .inputs-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Sanctum Playbook v3.0</h1>
            <div class="subtitle">Sistema Integral de Respuesta</div>
        </header>

        <div class="control-panel">
            <div class="inputs-grid">
                <div class="input-group">
                    <label>1. Cliente (Auto-Corregido)</label>
                    <input type="text" id="clientName" class="input-field" placeholder="ej: sofia (se convierte en Sofia)" oninput="updateScripts()" autocomplete="off">
                </div>
                <div class="input-group">
                    <label>2. Atiende (Opcional)</label>
                    <input type="text" id="senderName" class="input-field" placeholder="Vac√≠o = 'Sanctum'" oninput="updateScripts()" autocomplete="off">
                </div>
            </div>
            <div class="input-group">
                <label>3. Buscador Inteligente</label>
                <input type="text" id="searchFilter" class="input-field" placeholder="Escribe 'precio', 'retraso', 'cita', 'hola'..." oninput="filterScripts()">
            </div>
        </div>

        <div class="filter-nav">
            <button class="filter-btn active" onclick="filterByCategory('all')">üìö Todo</button>
            <button class="filter-btn" onclick="filterByCategory('saludo')">üëã Saludos (10)</button>
            <button class="filter-btn" onclick="filterByCategory('dinero')">üí∞ Dinero (10)</button>
            <button class="filter-btn" onclick="filterByCategory('objecion')">üõ°Ô∏è Objeciones (10)</button>
            <button class="filter-btn" onclick="filterByCategory('seguimiento')">üëÄ Seguimiento (10)</button>
            <button class="filter-btn" onclick="filterByCategory('crisis')">üö® Crisis/√âtica (5)</button>
        </div>

        <div id="scriptContainer" class="script-list"></div>
    </div>

    <div id="toast" class="toast">‚úÖ Copiado al portapapeles</div>

    <script>
        // --- BASE DE DATOS MASIVA (45 SCRIPTS) ---
        const scriptsDB = [
            
            // --- CATEGOR√çA: SALUDOS (10 Variaciones) ---
            { cat: 'saludo', title: '1. Lead Nuevo (Web/Ads)', tag: 'Est√°ndar', text: "Hola *{{nombre}}* üëã, te saluda {{remitente}}, de Sanctum Home.\n\nRecibimos tu solicitud. Para darte el mejor diagn√≥stico, cu√©ntame: ¬øQu√© espacio de tu hogar quieres transformar en un refugio de paz? üåø" },
            { cat: 'saludo', title: '2. Lead Referido (VIP)', tag: 'Calidez', text: "Hola *{{nombre}}*, un gusto saludarte. Soy {{remitente}}. üëã\n\nMe comentaron que buscas renovar tu espacio. Ya nos pusieron en contexto de tu buen gusto.\n\n¬øTienes 5 minutos para que hablemos sobre lo que tienes en mente? ‚ú®" },
            { cat: 'saludo', title: '3. Lead Arquitecto/Dise√±ador', tag: 'B2B', text: "Hola Arq. *{{nombre}}*, un placer. Habla {{remitente}}, del √°rea t√©cnica de Sanctum.\n\nNos encanta colaborar con colegas. ¬øTe gustar√≠a enviarnos tus planos para apoyarte con la ingenier√≠a del mobiliario? üìê" },
            { cat: 'saludo', title: '4. Respuesta Fuera de Horario (Noche)', tag: 'Auto', text: "Hola *{{nombre}}*. Recib√≠ tu mensaje. ‚ú®\n\nEl equipo de dise√±o ya est√° descansando, pero ma√±ana a las 9:00 AM ser√°s mi primera prioridad. Que tengas una noche de paz. üåô" },
            { cat: 'saludo', title: '5. Respuesta Fin de Semana', tag: 'Auto', text: "Hola *{{nombre}}*. Gracias por escribir. üåø\n\nEstamos recargando energ√≠a este fin de semana. El lunes a primera hora reviso tu proyecto personalmente. ¬°Disfruta tu descanso!" },
            { cat: 'saludo', title: '6. Cliente Antiguo (Recompra)', tag: 'Fidelizaci√≥n', text: "¬°Qu√© gusto saber de ti de nuevo, *{{nombre}}*! üëã\n\nEspero que sigan disfrutando su cocina. Cu√©ntame, ¬øqu√© nueva locura o mejora est√°n planeando ahora? Sabes que su casa es nuestra casa." },
            { cat: 'saludo', title: '7. Saludo "Solo estoy viendo"', tag: 'Soft', text: "Totalmente v√°lido, *{{nombre}}*. La inspiraci√≥n es el primer paso.\n\nTe invito a seguir nuestro Instagram para ideas. Cuando est√©s listo/a para aterrizar el proyecto, aqu√≠ estaremos. üåø" },
            { cat: 'saludo', title: '8. Saludo Post-Reuni√≥n', tag: 'Seguimiento', text: "Un gusto conocerte hoy, *{{nombre}}*. ü§ù\n\nMe qued√© pensando en lo que dijiste sobre la iluminaci√≥n. Ma√±ana te env√≠o la propuesta formal con ese detalle resuelto. ¬°Hablamos pronto!" },
            { cat: 'saludo', title: '9. Confirmaci√≥n de Cita', tag: 'Log√≠stica', text: "Hola *{{nombre}}*, solo para confirmar nuestra visita t√©cnica ma√±ana a las 11:00 AM en tu domicilio. üìç\n\nIr√° nuestro arquitecto senior para tomar medidas l√°ser. ¬øTodo sigue en pie?" },
            { cat: 'saludo', title: '10. Bienvenida al Firmar', tag: 'Onboarding', text: "¬°Bienvenido/a a la familia Sanctum, *{{nombre}}*! ü•Ç\n\nAcabamos de recibir el anticipo. A partir de hoy, yo ({{remitente}}) ser√© tu gu√≠a personal hasta que installemos el √∫ltimo tornillo. ¬°Empezamos!" },

            // --- CATEGOR√çA: DINERO (10 Variaciones) ---
            { cat: 'dinero', title: '1. ¬øCu√°nto cuesta el metro?', tag: 'Educaci√≥n', text: "Entiendo que el presupuesto es clave, *{{nombre}}*. üßê\n\nEn Sanctum no cotizamos 'por metro' porque no usamos materiales gen√©ricos. El costo var√≠a seg√∫n los herrajes y acabados que elijas.\n\n¬øAgendamos 10 min para darte un rango honesto?" },
            { cat: 'dinero', title: '2. "Es muy caro"', tag: 'Valor', text: "Es verdad, *{{nombre}}*, no somos la opci√≥n m√°s barata, y no intentamos serlo.\n\nNuestros precios garantizan herrajes Blum (Austria) y una instalaci√≥n perfecta que dura 15 a√±os. Preferimos explicar el precio una vez, que pedir perd√≥n por la calidad despu√©s. üõ°Ô∏è" },
            { cat: 'dinero', title: '3. "Tengo una cotizaci√≥n m√°s barata"', tag: 'Comparativa', text: "Totalmente comprensible. Si la otra opci√≥n te ofrece tableros hidr√≥fugos y herrajes Blum Legrabox por ese precio, ¬°es una ganga!\n\nSolo aseg√∫rate de que est√© por escrito en el contrato. Si gustas, revisamos ambas cotizaciones juntos para comparar peras con peras. üçé" },
            { cat: 'dinero', title: '4. "¬øPor qu√© cobran el dise√±o?"', tag: 'Expertise', text: "Buena pregunta, *{{nombre}}*. El dise√±o no es un 'dibujo', es un plano de ingenier√≠a.\n\nCobramos el anteproyecto porque dedicamos horas de arquitectos expertos. Si decides fabricar con nosotros, ese costo se abona al 100% a tu producci√≥n. Es un ganar-ganar. ü§ù" },
            { cat: 'dinero', title: '5. Petici√≥n de Descuento', tag: 'Pol√≠tica', text: "Me encantar√≠a, *{{nombre}}*, pero en Sanctum practicamos 'Mejor Precio Real'.\n\nNo inflamos los precios para luego hacer descuentos falsos. El precio que ves es el costo justo por la calidad de los materiales importados. Lo que s√≠ puedo hacer es ajustar materiales para bajar el total. ¬øLo revisamos?" },
            { cat: 'dinero', title: '6. Desglose de Costos', tag: 'Transparencia', text: "Claro, *{{nombre}}*. Aqu√≠ operamos con Libros Abiertos.\n\nTe anexo el desglose: Materiales (60%), Mano de Obra Especializada (25%), Log√≠stica y Gesti√≥n (15%). No hay costos ocultos. üìä" },
            { cat: 'dinero', title: '7. "¬øPuedo comprar yo los electrodom√©sticos?"', tag: 'Flexibilidad', text: "¬°Por supuesto! Eres libre de comprarlos donde gustes, *{{nombre}}*.\n\nSolo necesito que me env√≠es las fichas t√©cnicas antes de fabricar para asegurar que los huecos en la madera sean milim√©tricos. üìê" },
            { cat: 'dinero', title: '8. Fluctuaci√≥n D√≥lar/Euro', tag: 'Contexto', text: "Importante mencionar, *{{nombre}}*: Como usamos herrajes europeos, esta cotizaci√≥n es v√°lida por 15 d√≠as.\n\nSi el tipo de cambio var√≠a dr√°sticamente, tendremos que actualizarla. Te recomiendo congelar el precio con el anticipo. üìâ" },
            { cat: 'dinero', title: '9. Pagos a Meses', tag: 'Financiamiento', text: "S√≠ podemos diferirlo, *{{nombre}}*. Trabajamos con pasarelas de pago seguras.\n\nConsidera que la comisi√≥n bancaria por meses sin intereses (aprox 4-10%) se suma al total, ya que es un costo del banco, no nuestro. ¬øTe hago la simulaci√≥n?" },
            { cat: 'dinero', title: '10. Sobrecosto por Cambios', tag: 'Claridad', text: "Ojo, *{{nombre}}*. Como el mueble ya est√° en producci√≥n, hacer este cambio implica desperdiciar material ya cortado.\n\nEl costo adicional ser√≠a de $[Monto]. Necesito tu autorizaci√≥n escrita para proceder y ajustar la factura. üìù" },

            // --- CATEGOR√çA: OBJECIONES/T√âCNICO (10 Variaciones) ---
            { cat: 'objecion', title: '1. "Tardan mucho (8 semanas)"', tag: 'Tiempo', text: "S√© que parece mucho tiempo, *{{nombre}}*. ‚è≥\n\nPodr√≠amos entregarlo en 3 semanas usando pegamentos r√°pidos y tableros est√°ndar, pero se despegar√≠an en un a√±o. Nuestro proceso de curado y control de calidad toma tiempo para garantizarte durabilidad real." },
            { cat: 'objecion', title: '2. Ruido y Polvo en Casa', tag: 'Log√≠stica', text: "Te entiendo, las obras son invasivas. üßπ\n\nPor eso en Sanctum pre-armamos el 90% en taller. En tu casa solo haremos ensamblaje final para minimizar el ruido y el polvo. Ser√°n solo 2-3 d√≠as de molestia, lo prometo." },
            { cat: 'objecion', title: '3. "¬øQu√© garant√≠a tengo?"', tag: 'Seguridad', text: "Tu inversi√≥n est√° blindada, *{{nombre}}*. üõ°Ô∏è\n\nOfrecemos 1 a√±o en mano de obra y garant√≠a de por vida en herrajes Blum (directo con proveedor). Todo queda estipulado en tu contrato ante notario si as√≠ lo deseas." },
            { cat: 'objecion', title: '4. "Mi carpintero lo hace igual"', tag: 'Calidad', text: "Respeto mucho el oficio. La diferencia es la ingenier√≠a.\n\nUn carpintero suele cortar en sitio (polvo/imprecisi√≥n). Nosotros usamos m√°quinas CNC computarizadas que cortan con precisi√≥n de 0.1mm. El acabado es industrial, no artesanal. ‚ú®" },
            { cat: 'objecion', title: '5. "¬øPuedo usar mi granito?"', tag: 'T√©cnico', text: "S√≠, *{{nombre}}*, podemos hacer solo la carpinter√≠a.\n\nSolo ten en cuenta que no podemos dar garant√≠a sobre la instalaci√≥n de la piedra si es un proveedor externo, y tendr√≠amos que coordinarnos muy bien para los tiempos. üìÖ" },
            { cat: 'objecion', title: '6. Cambio de Dise√±o a √∫ltima hora', tag: 'Fricci√≥n', text: "Hagamos una pausa, *{{nombre}}*. üõë\n\nPodemos hacer el cambio, pero mover la estufa implica romper piso e instalaci√≥n hidr√°ulica nueva. ¬øEst√°s dispuesto a asumir esa obra civil extra? Quiero asegurarme de que sepas el impacto." },
            { cat: 'objecion', title: '7. Dudas sobre materiales (Melamina vs Madera)', tag: 'Educaci√≥n', text: "Es un mito com√∫n. La madera s√≥lida se hincha y tuerce con la humedad de la cocina.\n\nUsamos tableros hidr√≥fugos de ingenier√≠a (Vesto/Arauco) dise√±ados espec√≠ficamente para resistir agua y calor. Es tecnolog√≠a, no ahorro. üî¨" },
            { cat: 'objecion', title: '8. "¬øQui√©n supervisa la obra?"', tag: 'Confianza', text: "Yo personalmente ({{remitente}}) superviso, junto con el Jefe de Taller.\n\nTendr√°s un grupo de WhatsApp donde subiremos fotos diarias del avance. Nunca estar√°s a ciegas. üëÄ" },
            { cat: 'objecion', title: '9. Espacio Peque√±o', tag: 'Soluci√≥n', text: "¬°Los espacios peque√±os son nuestro reto favorito! üß©\n\nCon los herrajes correctos podemos duplicar tu capacidad de almacenaje. D√©jame ense√±arte unos cajones ocultos que te van a encantar." },
            { cat: 'objecion', title: '10. Miedo a que quede mal', tag: 'Empat√≠a', text: "Es normal tener miedo en una remodelaci√≥n. ü§ç\n\nPor eso antes de cortar una sola tabla, te entregamos Renders 3D fotorrealistas. No avanzamos hasta que veas en la pantalla exactamente lo que tendr√°s en tu casa." },

            // --- CATEGOR√çA: SEGUIMIENTO/CIERRE (10 Variaciones) ---
            { cat: 'seguimiento', title: '1. Ghosting (Suave)', tag: 'Nudge', text: "Hola *{{nombre}}* üëã. No quiero ser una interrupci√≥n.\n\nSolo quer√≠a saber si el proyecto sigue siendo una prioridad este mes, o prefieres que lo retomemos m√°s adelante. Cualquier respuesta est√° bien. ‚ú®" },
            { cat: 'seguimiento', title: '2. Ghosting (Definitivo)', tag: 'Cierre', text: "Hola *{{nombre}}*. Como no hemos tenido noticias, voy a cerrar tu expediente por ahora para no llenarte de mensajes. üìÇ\n\nCuando est√©s listo/a para retomar, solo escr√≠beme. ¬°Aqu√≠ estaremos!" },
            { cat: 'seguimiento', title: '3. Enviar Contrato', tag: 'Admin', text: "Listo, *{{nombre}}*. Te adjunto el contrato de prestaci√≥n de servicios. üìù\n\nPor favor l√©elo con calma. Ah√≠ vienen especificadas las fechas, materiales y garant√≠as. Cualquier duda legal, la revisamos." },
            { cat: 'seguimiento', title: '4. Recibo de Anticipo', tag: 'Finanzas', text: "¬°Confirmado! Recibimos tu transferencia. ‚úÖ\n\nYa gir√© la orden de compra de los materiales. Tu fecha estimada de instalaci√≥n es la semana del [Fecha]. Te mantendr√© informado." },
            { cat: 'seguimiento', title: '5. Agendar Instalaci√≥n', tag: 'Log√≠stica', text: "¬°Buenas noticias *{{nombre}}*! Tu mobiliario est√° listo. üöõ\n\n¬øTe queda bien que iniciemos la instalaci√≥n el [D√≠a] a las 9:00 AM? Necesitamos que el √°rea est√© despejada." },
            { cat: 'seguimiento', title: '6. Check-list Final', tag: 'Calidad', text: "Ma√±ana terminamos, *{{nombre}}*. üèÅ\n\nQuiero hacer el recorrido final contigo para que revises cada caj√≥n y puerta. No nos vamos hasta que me firmes de total conformidad." },
            { cat: 'seguimiento', title: '7. Petici√≥n de Fotos', tag: 'Marketing', text: "Tu cocina qued√≥ espectacular, *{{nombre}}*. üòç\n\n¬øNos dar√≠as permiso de enviar a nuestro fot√≥grafo para tomar unas capturas para nuestro portafolio? Te regalamos las fotos profesionales para ti." },
            { cat: 'seguimiento', title: '8. Petici√≥n de Review', tag: 'Social', text: "Hola *{{nombre}}*. Si te gust√≥ la experiencia Sanctum, ¬ønos ayudar√≠as con una breve rese√±a en Google?\n\nNos ayuda much√≠simo a que m√°s personas conf√≠en en la honestidad radical. ‚≠ê" },
            { cat: 'seguimiento', title: '9. Solicitud de Referidos', tag: 'Ventas', text: "Fue un placer trabajar contigo. Si tienes alg√∫n amigo que est√© sufriendo con su cocina actual, p√°sale mi contacto.\n\nLos trataremos con el mismo cari√±o que a ti. üåø" },
            { cat: 'seguimiento', title: '10. Chequeo a los 3 meses', tag: 'Post-Venta', text: "Hola *{{nombre}}*. Solo pasaba a saludar. üëã\n\n¬øC√≥mo se han portado los herrajes estos meses? ¬øAlg√∫n ajuste que necesites? Recuerda que tu garant√≠a sigue activa." },

            // --- CATEGOR√çA: CRISIS/√âTICA (5 Cr√≠ticos) ---
            { cat: 'crisis', title: '1. Reporte de Error (Honestidad)', tag: 'Radical', text: "Hola *{{nombre}}*, te escribo con total transparencia.\n\nUna pieza lleg√≥ con un defecto de f√°brica. Podr√≠a instalarla y taparlo, pero no es nuestro estilo. üõë\n\nPed√≠ el reemplazo urgente. Esto nos retrasa 2 d√≠as, pero prefiero que quede perfecto. Gracias por tu paciencia. üôè" },
            { cat: 'crisis', title: '2. Petici√≥n Pago Efectivo (Sin IVA)', tag: '√âtica', text: "Aprecio la propuesta, *{{nombre}}*, pero en Sanctum practicamos la Transparencia Total.\n\nTodo debe ser facturado para proteger legalmente tu garant√≠a y el seguro de los materiales. Es por tu seguridad y la nuestra. ‚öñÔ∏è" },
            { cat: 'crisis', title: '3. Cliente molesto (Escucha activa)', tag: 'Crisis', text: "Te escucho y entiendo tu molestia, *{{nombre}}*. Tienes toda la raz√≥n en estar enojado/a.\n\nNo voy a poner excusas. D√©jame hablar con el equipo ya mismo para ver c√≥mo solucionamos esto hoy. Te llamo en 10 min con un plan. üõ†Ô∏è" },
            { cat: 'crisis', title: '4. Da√±o en obra (Accidente)', tag: 'Responsabilidad', text: "Hola *{{nombre}}*. Te informo que durante la instalaci√≥n, rozamos la pintura de la pared accidentalmente. üòî\n\nYa agend√© a nuestro pintor para que vaya a repararlo ma√±ana sin costo alguno. Nos hacemos 100% responsables." },
            { cat: 'crisis', title: '5. Rechazo de Proyecto (No alineado)', tag: 'L√≠mites', text: "Gracias por considerarnos, *{{nombre}}*. \n\nAnalizando el proyecto, creo que no somos la mejor opci√≥n para lo que buscas (low-cost/urgente). Preferimos decirte que NO, a darte un mal servicio. Te deseo mucho √©xito en la obra. ‚ú®" },
        ];

        // --- MOTOR L√ìGICO OPTIMIZADO ---
        const container = document.getElementById('scriptContainer');
        const nameInput = document.getElementById('clientName');
        const senderInput = document.getElementById('senderName');
        const searchInput = document.getElementById('searchFilter');
        let currentCategory = 'all';

        function formatName(raw) {
            if(!raw) return "";
            return raw.trim().toLowerCase().replace(/(?:^|\s|['"([{])+\S/g, m => m.toUpperCase());
        }

        function renderScripts() {
            container.innerHTML = '';
            
            let clientRaw = formatName(nameInput.value);
            let clientName = clientRaw || "[Nombre]";
            
            let senderRaw = formatName(senderInput.value);
            let senderName = senderRaw || "Sanctum"; // Fallback Institucional

            const filterText = searchInput.value.toLowerCase();

            const filtered = scriptsDB.filter(s => {
                const matchCat = currentCategory === 'all' || s.cat === currentCategory;
                const matchSearch = s.title.toLowerCase().includes(filterText) || s.text.toLowerCase().includes(filterText) || s.tag.toLowerCase().includes(filterText);
                return matchCat && matchSearch;
            });

            if (filtered.length === 0) {
                container.innerHTML = `<div style="text-align:center;color:#999;padding:40px;">No encontr√© scripts. Intenta otra palabra.</div>`;
                return;
            }

            filtered.forEach(s => {
                // Render Visual (con highlights)
                let display = s.text
                    .replace(/{{nombre}}/g, `<span class="highlight-name">${clientName}</span>`)
                    .replace(/{{remitente}}/g, `<b>${senderName}</b>`)
                    .replace(/\n/g, '<br>');

                // Copy Text (limpio)
                let copy = s.text
                    .replace(/{{nombre}}/g, clientName)
                    .replace(/{{remitente}}/g, senderName);

                const card = document.createElement('div');
                card.className = 'script-card';
                card.onclick = () => copyToClipboard(copy);
                card.innerHTML = `
                    <div class="card-header">
                        <span class="card-title">${s.title}</span>
                        <span class="card-tag">${s.tag}</span>
                    </div>
                    <div class="card-body">
                        <div class="whatsapp-bubble">${display}</div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function updateScripts() { renderScripts(); }
        function filterScripts() { renderScripts(); }
        
        function filterByCategory(cat) {
            currentCategory = cat;
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            // Limpiar b√∫squeda al cambiar categor√≠a para no confundir
            searchInput.value = '';
            renderScripts();
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                const t = document.getElementById('toast');
                t.classList.add('show');
                setTimeout(() => t.classList.remove('show'), 2000);
            });
        }

        renderScripts();
    </script>
</body>
</html>